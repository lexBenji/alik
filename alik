#!/usr/bin/python3

from sys import argv
from string import ascii_letters as alpha

if len(argv) == 1:
   raise SystemExit

file=""
fset=False

line=0
col=0

state=0
word=""
write=False
writeln=False
raw=False
_str=""
quote=""

version="1.01"

valid_flags=[
      "-v",
      "-version",
      "-h",
      "-help"
      ]

keyword=[
      "echo",
      "raw"
      ]

cur=""

for arg in argv:
   if arg.endswith(".alik"):
      file=arg
      fset=True
   elif arg.startswith("-") and arg in valid_flags:
      if arg == "-v" or arg == "-version":
         print("Current version: {0}".format(version))
      elif arg == "-h" or arg == "-help":
         print(valid_flags)
         raise SystemExit

if fset==False:
   raise SystemExit

with open(file) as rf:
   rf=rf.readlines()
   while True:
      cur=rf[line][col]
      if state==0:
         if cur in alpha:
            word+=cur
         else:
            if word == "write":
               write=True
               word=""
            elif word=="writeln":
               writeln=True
               word=""
            elif word == "raw":
               raw=True
               word=""
            elif cur in "\"'":
               quote=cur
               state=1
            elif cur in " \t":
               pass
            elif cur == "\n":
               if write:
                  if raw:
                     print(repr(_str)[1:len(repr(_str))-1],end="")
                     raw=False
                  else:
                     print(_str,end="")
                  write=False
                  _str=""
               elif writeln:
                  if raw:
                     print(repr(_str)[1:len(repr(_str))-1])
                     raw=False
                  else:
                     print(_str)
                  writeln=False
                  _str=""
               if line==len(rf)-1:
                  raise SystemExit
               line+=1
               col=-1
            elif cur == ";":
               if write:
                  if raw:
                     print(repr(_str)[1:len(repr(_str))-1],end="")
                     raw=False
                  else:
                     print(_str,end="")
                  write=False
                  _str=""
               elif writeln:
                  if raw:
                     print(repr(_str)[1:len(repr(_str))-1])
                     raw=False
                  else:
                     print(_str)
                  writeln=False
                  _str=""
            elif not word in keywords:
               raise SyntaxError("{0} is not a keyword".format(word))
      elif state==1:
         if cur in "\"'" and quote==cur:
            state=0
         else:
            _str+=cur
      col+=1
